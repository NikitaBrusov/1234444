# Асинхронное взаимодействие

Очереди предоставляют буфер для временного хранения сообщений и конечные точки, которые позволяют подключаться к очереди для отправки и получения сообщений в **асинхронном режиме**.

В сообщениях могут содержаться запросы, ответы, ошибки и иные данные, передаваемые между программными компонентами. Компонент, называемый производителем (Producer), добавляет сообщение в очередь, где оно будет храниться, пока другой компонент, называемый потребителем (Consumer), не извлечет сообщение и не выполнит с ним необходимую операцию.

<figure><img src="../.gitbook/assets/3-2.webp" alt=""><figcaption><p>Очередь сообщений</p></figcaption></figure>

Так как очереди могут использоваться несколькими производителями и потребителями одновременно, обычно их реализуют с помощью дополнительной системы, называемой брокером. Брокер сообщений (Message Broker) занимается сбором и маршрутизацией сообщений на основе предопределенной логики. Сообщения могут передаваться с некоторым ключом — по этому ключу брокер понимает, в какую из очередей (одну или несколько) должно попасть сообщение.



## Kafka

Кафка. Для чего нужны massages broker? Что такое топик? Что такое партиция?

\


Кластер Кафка состоит из брокеров.

Брокер - это посредник передачи сообщений между сервисами.

Сущесвует две сущности: продюсер - издатель сообщений и консюмер - подписчик

\* Сообщения отправляются напрямую от П к К

\* Схема публицкации/подписок

П не знает К, поэтому публикует сообщение в топик. Консюмеры которые подписаны на этот топик забирают сообщение.

\


Для чего нужно?

\*Отказоустойчивость. Даже если получатель недоуступен, то продюсер всё равно сможет опубликовать сообщение (но в топик)

\*За счёт асинхронной работы можно увеличивать производительность

\


Когда использовать брокер?

\*Действия, которые требуют много времени, но не требуют мнгновенного результата

\*Микросервисы: каждый сервис подписывется только на свой топик и получает сообщения из него

\*Моб приложения.Смартфон подписан на топик - когда там появляется сообщение - смартфон выводит пуш

\


Что такое топик?

Топик - это логическое разделение категорий сообщений на группы. Для того чтобы читать актуальные сообщения в каждом топике есть специальный указатель - порядковый номер (offset), который отвечает за смещение курсора на следующее сообщение в очереди.

Что такое партиция?

Бывают такие случаи, когда сообщение в топики приходят быстрее, чем уходят из него. Специально для этого в Kafka-топиках предусмотрены разделы (partition), которые разделяют очереди с целью защиты топика от переполнения.

\


ИТОГО

Кластер - брокер - топики - партиции - сегменты

Обратите внимание, что в Kafka топик — это логическое объединение, а партиция — фактическая единица хранения.
